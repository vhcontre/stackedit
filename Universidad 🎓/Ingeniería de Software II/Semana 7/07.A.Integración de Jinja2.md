## 📅 Integración de Jinja2

| Semana | Objetivos principales                                             |
| ------ | ----------------------------------------------------------------- |
| 7      | 🌐 Integración de Jinja2 para interfaz web                        |
|        | 📄 Creación de plantillas y rutas web básicas                     |

¡Excelente! Con esa estructura clara y profesional, podemos implementar la **interfaz web con Jinja2** de forma **ordenada** y alineada con tu arquitectura en FastAPI. Vamos a adaptar lo que mencionamos antes al contexto real de tu proyecto:

---

## ✅ ¿Qué haremos ahora?

1. Usarás `Jinja2` dentro de tu proyecto FastAPI.
2. Serviremos plantillas HTML desde `app/templates/`.
3. Serviremos archivos estáticos desde `app/static/`.
4. Crearemos una ruta como `/web/productos` que renderice una tabla de productos desde la base de datos.

---

## 🧩 PASO A PASO para integrar Jinja2 en tu proyecto `inventario-2025`

---

### 🔧 Paso 1: Asegurate de tener `Jinja2` y `aiofiles` instalados

```bash
pip install jinja2 aiofiles
```

> `aiofiles` es necesario para servir archivos estáticos con `FastAPI`.

---

### 🧱 Paso 2: Configurar plantillas y estáticos en `main.py`

En `app/main.py`, agregá al inicio:

```python
from fastapi import FastAPI, Request
from fastapi.staticfiles import StaticFiles
from fastapi.templating import Jinja2Templates
from pathlib import Path
```

Y en la instancia principal de FastAPI:

```python
app = FastAPI()

BASE_DIR = Path(__file__).resolve().parent

# Archivos estáticos (CSS, JS, imágenes)
app.mount("/static", StaticFiles(directory=BASE_DIR / "static"), name="static")

# Plantillas HTML
templates = Jinja2Templates(directory=BASE_DIR / "templates")
```

---

### 🗂️ Paso 3: Crear carpetas y archivos

Asegurate de tener esta estructura ya creada dentro de `backend/app/`:

```
app/
├── templates/
│   ├── base.html
│   └── productos.html
├── static/
│   └── styles.css  (opcional)
```

---

### 🧪 Paso 4: Crear la plantilla base (`base.html`)

```html
<!-- app/templates/base.html -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Inventario{% endblock %}</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <header>
        <h1>📦 Sistema de Inventario</h1>
        <nav>
            <a href="/web/productos">Productos</a>
        </nav>
    </header>

    <main>
        {% block content %}{% endblock %}
    </main>
</body>
</html>
```

---

### 📦 Paso 5: Crear plantilla de productos (`productos.html`)

```html
<!-- app/templates/productos.html -->
{% extends "base.html" %}

{% block title %}Listado de Productos{% endblock %}

{% block content %}
<h2>Productos en Inventario</h2>
<table border="1">
    <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>Stock</th>
    </tr>
    {% for producto in productos %}
    <tr>
        <td>{{ producto.id }}</td>
        <td>{{ producto.nombre }}</td>
        <td>{{ producto.stock }}</td>
    </tr>
    {% endfor %}
</table>
{% endblock %}
```

---

### 🚏 Paso 6: Crear ruta en FastAPI (`app/routers/web_interface.py`)

```python
from fastapi import APIRouter, Request, Depends
from app.db.session import get_db
from sqlalchemy.orm import Session
from fastapi.templating import Jinja2Templates
from app.main import templates  # Usa la misma instancia creada en main.py
from app.repositories.producto_repo import obtener_todos_los_productos

router = APIRouter()

@router.get("/web/productos")
def ver_productos(request: Request, db: Session = Depends(get_db)):
    productos = obtener_todos_los_productos(db)
    return templates.TemplateResponse("productos.html", {"request": request, "productos": productos})
```

> Ajustá el nombre del repositorio y esquema según tu implementación real (`producto_repo`, `schemas.Producto`, etc.).

---

### ⚙️ Paso 7: Registrar el router en `main.py`

En `app/main.py`, agregá:

```python
from app.routers import web_interface

app.include_router(web_interface.router)
```

---

## ✅ ¿Y cómo seguimos?

Una vez que veas los productos renderizados en tu navegador (en `http://localhost:8000/web/productos`):

* Podés agregar formularios para agregar o eliminar productos.
* Podés incorporar páginas como `/web/depositos`, `/web/alertas`, etc.
* Te ayudo a agregar paginación, filtros o incluso Bootstrap si querés mejorar la UI.

---

¿Querés que te prepare el `producto_repo.py` con una función tipo `obtener_todos_los_productos()` compatible con este flujo? ¿O querés seguir con los formularios y operaciones CRUD vía web?

<!--stackedit_data:
eyJoaXN0b3J5IjpbMTUxNTA0OTE0NCwxNDQ4OTc4OTcxXX0=
-->